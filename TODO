add options to control expansion team draft pick position
- FBGM should default to #1

runBefore sends viewData to worker... wouldn't it be better to keep it on worker? do we ever need anything but "latest state displayed on this tab"? maybe?

refactor game sim
- classes should share some common methods

dropdown list of cities on manage teams page
- https://discord.com/channels/290013534023057409/331882115119448065/933031128443539528

rank column on player stats page https://discord.com/channels/290013534023057409/331882115119448065/932355745616371813

minors
- add "type" property to stats row, could be playoffs, minors, or undefind (regular season)
  - or, add a "minors" flag?
  - same idea for regularSeason and playoffs flags in playersPlus
- configurable # of slots. default 0
- at the end of every day, assemble random teams of players in the minors and sim minors games
  - always keep same (pro) team together?
  - position balance needed for hockey/football?
- should minors lead to improvement? make it configurable, but default no
- need anything special with contracts?

fbgm kickoff return to own 0 https://discord.com/channels/290013534023057409/290015591216054273/932688109596975164

when starting a new league, contracts should be set not based on current state of player, but on state when contract was signed. especially noticable for rookies who progged a lot

sticky first column in most tables
- https://github.com/twbs/bootstrap/issues/31458
- https://discord.com/channels/290013534023057409/331882115119448065/932307788057681920

no awards if 0 games in regular season? https://discord.com/channels/290013534023057409/331882115119448065/930867153878544454

more goalie injuries? https://discord.com/channels/@me/926178075614523402/930545643578081320

dramatic reveal of awards and award voting results, similar to draft lottery
- https://discord.com/channels/290013534023057409/331882115119448065/935293110710317087

offsetting penalties broken on kickoff https://discord.com/channels/290013534023057409/290015591216054273/929998618331590667

on team history, graph of team ovr / winp / mov over time, star for championship
- maybe better on league history, to show for whole league?

manually specify draft order in god mode
- make draft page drag-and-drop, with purple handles

new achievements
- force challenge mode to remain on

hockey ovr revamp
- ovrs for skater and goalie. determine skater positions like BBGM, including possibility of hybrid positions like F. cause there's really a fair amount of overlap in what players do

more season preview stuff
- top rookies
- top free agent signings
- ...1 more needed
  - top young players? kind of redundant

for some fbgm penalties, don't allow the ball carrier to be called

soccer-style team names
- implementation
  - add two field allongside abbrev/region/name - customMedium and customLong
    - customMedium is a medium length name. if undefined, Region is used. could be defined to disambiguate two teams in the same reason, like "LA Earthquakes" and "LA Lowriders"
    - customLong is a long name. if undefined, Region Name is used. could be defined to have european-style team names
  - ...this still results in weird situations, like not knowing how to use the medium name in a sentence since it might be the city or it might be the team name, like is it plural or not?
- usually process in UI. maybe will need some in worker, like for notifications
- add to teamsPlus?
- @Ra98

getCopy/getCopies dry
- rename to idb.get/idb.getAll
- share code
- any place that uses this conditionally vs cache.get/getAll, use just getCopy and make sure it's no slower
  - lookup of single primary key (such as season or xid) should look in cache first and short circuit if found there

fbgm edge cases
- half the distance to the goal should also happen for offensive penalties, except pass interference https://mail.google.com/mail/u/0/#inbox/FMfcgzGllMLKdrcDDZTrvJDDlgkNBFTl
- defensive penalty on last possession of half/OT - should have one untimed down https://mail.google.com/mail/u/0/#inbox/FMfcgzGllVnWKrWXjxwNNXWTqsncqjNq

QB throw a Interception but their were two offsetting penalties so the down was replayed but it still counted the INT to the Stats. So the Safety still got credit for a pick https://discord.com/channels/290013534023057409/290015591216054273/917134502336270396
- similar situation with a score https://discord.com/channels/290013534023057409/569726303926878219/935283475685187684

bootstrap 5
- test
  - "More Info" dropdown alignment
    - same with top menu dropdowns

sack rate? https://discord.com/channels/@me/915839517829767218/915840315859034122

scale roster composition by roster size https://discord.com/channels/290013534023057409/331882115119448065/915593141174824961

customizable columns https://discord.com/channels/@me/914986660020748321
- figure out how to deal with per game vs total vs per 36 in BBGM - currently can't display together
- define "standard" columns available in some context (like "career total" or "individual season")
- deal with instability in the current column selection system - like if # of columns changes (sometimes due to season change), selection gets lost
- start gradually porting over some views

dropbox integration - save league to cloud
- add way to view leagues saved in dropbox account and select one from that list
- add support for dropbox url in hash so that all the league creation stuff is pre-filled

ai propose trades to user
- list candidates on a new Trade Offers page?

fbgm negative passes https://discord.com/channels/@me/625036115497451609/912909432919310336

add some way to auto find team colors based on logo
- https://lokeshdhakar.com/projects/color-thief/
- https://github.com/Vibrant-Colors/node-vibrant

use ovrStart/ovrEnd on power rankings page?
- show change from beginning of season or last season?

fix applying penalties on xp/2pt
- store scrimmage of 2pt, then xp is offset from that
  - wouldn't work for defensive penalties
- go for 2 after offensive penalty only if absolutley necessary (late in game)

hockey player does stuff on ice while in penalty box https://discord.com/channels/@me/778760871911751700/908163406111072326

combined regular season and playoffs on player stats page https://discord.com/channels/@me/819437830773538816/907468037312114718

add comparison to real player, for random player or draft prospect?
- https://twitter.com/messages/1928999030-3723150857
- draftRatings/seasonRatings/seasonStats/seasonPotential/careerRatings/careerStats
- "real life"/"your league" (only basketball)

fix ai value of reversed draft picks https://discord.com/channels/290013534023057409/290013534023057409/905048206457581598
- and random https://old.reddit.com/r/BasketballGM/comments/pyw33f/monthly_suggestions_thread/hg2t67n/

add archetypes to players?
- https://twitter.com/messages/1928999030-3723150857
- https://discord.com/channels/290013534023057409/290015468939640832/897791010225147954 https://www.bball-index.com/lebron-database/
  - https://www.bball-index.com/impact-metric-comparison/ for defense
- https://docs.google.com/spreadsheets/d/1JcA535OolPztKI9NT438MyZ6UJMh9sgbgUkeBnG0vjU/edit#gid=1556746814

https://github.com/lukeed/tsm
- see tsm branch, was getting errors in build
- move types to jsdoc?

configure assist rate https://discord.com/channels/290013534023057409/331882115119448065/897005671143313408

all-star snubs https://old.reddit.com/r/BasketballGM/comments/q53xkk/a_lil_feature_this_game_could_add/

better handle case where cannot play a game (like during contract negotiation) and player tries to live sim https://mail.google.com/mail/u/0/#all/FMfcgzGlkXrSgFVLkrnbVTGLQRjCHPDr

refactor FBGM play by play logging
- move text generation client side, like hockey
- typescript for log function

fbgm contract scaling
- https://discord.com/channels/290013534023057409/290015468939640832/895698503144194080

show timeouts in live sim https://discord.com/channels/@me/778760871911751700/894791547156070441
- https://discord.com/channels/290013534023057409/331882115119448065/898193635005325332

store results of trading block in database
- indicator of if the offer is still valid or not
  - can evaluate trade to see
- indicator if trade is invalid because an asset no longer exists on that team
- show what the user offered somewhere, not just what is checked

show all on trading block https://discord.com/channels/290013534023057409/331882115119448065/879050361564979210

football penalty later
- make spotOfEnforcementIndexes and cleanHandsChangeOfPossessionIndexes dynamic when computing penalties, like possessionChangeIndexes
- option to apply penalty on kickoff, for extra points
- option to redo punt or not
- double foul after change of possession edge cases to test
  - If this spot is normally a touchback, the ball is placed on the 20-yard line.  
  - If normally a safety, place the ball on one-yard line. 

football game sim later
- should separate catch and run after catch
  - track yards after catch stat
  - fix location of interceptions - at catch, not later
  - fix location of defensive pass interference penalty - should be at spot of catch, not earlier https://discord.com/channels/290013534023057409/290015591216054273/894407045527244930
  - tackOn fouls would need to be adjusted to go after the run too
- no 2 point conversions in blowouts

nicidob improve value formula
- https://discord.com/channels/290013534023057409/290015591216054273/891394602207174656
- https://discord.com/channels/290013534023057409/290015468939640832/893115141015625779

more dramatic play-by-play
- pass attempt and description before result
- fg attempt before result
- run after catch
- fumble handoff
- flags at various times
  - need to be smart enough to roll back to last relevant ball position, which could be scrimmage

extra man stays on ice in overtime https://discord.com/channels/@me/778760871911751700/892224214118039624

rarely, elam ending doesn't get triggered https://discord.com/channels/290013534023057409/290015591216054273/891454150783692821

improve table column filtering
- AND operation
  - how to handle mixing with OR?
- parentheses to group operations

better adjustment for real draft prospects

don't use positions in substitution, or be less rigid about it https://discord.com/channels/@me/667557235479674880
- ideally - look at ratings, not positions

custom draft odds https://old.reddit.com/r/BasketballGM/comments/ovhv1i/monthly_suggestions_thread/h7fmam6/

show playoff seeds on team history page https://old.reddit.com/r/BasketballGM/comments/phc895/hi_everyone_could_i_make_a_request_that_this/

show total of selected contracts on trading block slg
- more stuff too? https://discord.com/channels/290013534023057409/331882115119448065/881220276329779231

playoffsByConf should support numConfs!=2
- if power of 2, divides evenly
- otherwise, would need byes after the conferences are done.
  - how to pick which team gets bye?
  - 1950 nba playoffs

player being let out of the penalty box at start of overtime? https://discord.com/channels/@me/778760871911751700/879161429335367760

More preset league structures
- https://discord.com/channels/290013534023057409/331882115119448065/876662349287804938

show tenths of seconds in live sim play by play

free throws with no time left https://github.com/zengm-games/zengm/issues/392

player ratings stats popover, allow switching season
- include peak and career as options
- one switch for ratings and stats (For career, show peak ratings)
- https://discord.com/channels/290013534023057409/331882115119448065/874769773051936848
- https://discord.com/channels/290013534023057409/331882115119448065/935369006985117697

https://github.com/zengm-games/zengm/pull/346/files

roundsWonText needs to use playoffsByConf
- DRY - leagueDashboard.ts has some too, maybe elsewhere also?
- allow customizing names of rounds? https://mail.google.com/mail/u/0/#sent/FMfcgzGkZkZXnjWXKHgNrlblwJQRDXNt

report of AI not signing its draft picks in ZGMH https://discord.com/channels/290013534023057409/290015591216054273/872562739510378547

daily schedule
- option to stay on "today" or "yesterday" as days are simmed https://discord.com/channels/290013534023057409/331882115119448065/870351405746126918

dashboard overflow https://discord.com/channels/290013534023057409/290015591216054273/870207944975872050

schedule customization
- eventually
  - somehow get rid of perGame stuff and make them all excess, to better handle unbalanced divs/confs
    - how to define when a set of matchups is as good as we can do? generate a bunch and keep the best scoring one?
  - option to make the settings like "# games vs each division opponent" if someone wants that behavior for a league where divisions are not equal size

frivolities
- players
  - Best/Worst MVP, DPOY, ROY, 6MOY, MIP https://old.reddit.com/r/BasketballGM/comments/ovhv1i/monthly_suggestions_thread/h7iovrv/
  - would need history of salaryCap
    - most overpaid, most underpaid (career total)
    - best contract (maybe WS:contract ratio? or WS minus "expected WS for that contract"?)
    - worst contract
  - GOAT Lab for seasons
  - highest ovr at each age https://discord.com/channels/290013534023057409/331882115119448065/868031573205876778
  - best rookie season https://old.reddit.com/r/BasketballGM/comments/p5stae/best_rookie_seasons_frivolty/
- team seasons
  - most consecutive seasons w/ championships/finals/playoffs/no-playoffs
  - best playoffs (record in individual playoffs) - annoying to implement in frivolitiesTeamSeasons
  - oldest/youngest champions https://old.reddit.com/r/BasketballGM/comments/o668ok/a_teams_average_age_weighted_by_minutes_played_is/h2rbp7g/?context=3
  - GOAT Lab for teams https://discord.com/channels/290013534023057409/331882115119448065/864892186888765502
- oldest/youngest award winners for each award https://discord.com/channels/290013534023057409/331882115119448065/898189161536839691
- Youngest and Oldest ever to achieve certain statistical feats like triple doubles and 50 pointers https://discord.com/channels/290013534023057409/331882115119448065/904435732842700810
- playoffs
  - playoff seeding, like number of times an 8 seed won @Tuxie93
- best dunk (scan dunk contest for highest difficulty dunnk completed, and show actual score and probability too)

show best performer(s) by score on schedule page https://discord.com/channels/290013534023057409/331882115119448065/862565411262169098
- make sure it agrees with all star MVP, finals MVP
- how to pick stats to display? give each stat a point value, add up score, pick highest total score for player, and then pick stats as highest individual stat scores for player
- player of the game in box score https://discord.com/channels/@me/810011526097534977/820501123944939530

ratings distributions by position https://discord.com/channels/290013534023057409/331882115119448065/862853531231977513

all advanced stats have always disregarded the previous team's stats for traded players, but that can have a big impact on things like normalizing PER to an average of 15 leaguewide if there are a lot of high minutes high/low PER traded players.

Fix hardcoded 90000 in attendance.ts and writeTeamStats.ts

injuries
- make more representative of football: https://footballplayershealth.harvard.edu/wp-content/uploads/2017/05/06_Ch2_Injuries.pdf
  - https://discord.com/channels/290013534023057409/290015468939640832/859264726247800832
- hockey
  - https://discord.com/channels/290013534023057409/290015468939640832/859262222873526272

FBGM
- lower salaries https://discord.com/channels/290013534023057409/331882115119448065/856734085191041024
- fewer RB2 carries

option to exclude notable games box scores from deletion
- ASG
- statistical feats
- buzzer beaters
- playoffs
- finals
- games involving your team
- firefox auto delete performance
  - do what we do now if no need to check actual box score
  - otherwise, maybe move to newPhasePreseason and run async in background

beter handling of customizable columns in tables where the defaults change based on some URL parameter
- "Customized columns on League Stats break a bit when you filter for a different team. So swap STL/BLK and change from All to w/e squad, and you'll see BLK just wholly disappear." https://discord.com/channels/290013534023057409/290015591216054273/855827200577765387

ZGMH all contending https://discord.com/channels/290013534023057409/290015591216054273/851150025966747678
- happens in any league if oyu play for a while

some way to pin trades?
- UI? trading block and trade page? updating a pinned trade?
- needs to include what user is trading for, in case that changes
- indicator of if the offer is still valid or not
  - can evaluate trade to see

cancel expansion draft can leave you in control of inactive team https://mail.google.com/mail/u/0/#inbox/FMfcgzGkXdCQjTRbGcgzmdrZTMFLHQbZ

player game log
- later
  - totals at bottom
  - click two rows, popup shows avg over that timespan, like basketball-reference

Adjust team rating based on the adjusted ovr of players who are playing through injury... so that we can see accurate playoff point spreads based on who we have playing, and see how playing and resting an injured player effects our speads/TR https://discord.com/channels/290013534023057409/331882115119448065/849075933206151230
- team.ovr needs to take playThroughInjuries as an argument, and take all players not just healthy ones. then needs to adjust players by playThroughInjuriesFactor
  - do injured/healthy with a flag rather than a filtered list
  - if doing injured one, require playThroughInjuries to be passed too
- update team.ovr calls
  - powerRankings.ts
  - roster.ts
  - schedule.ts
  - recomputeLocalUITeamOvrs
  - loadTeams.ts

in garbage time, rest players who are playing through injuries

https://en.wikipedia.org/wiki/Three_stars_(ice_hockey)

wrong team abbrev various places
- box score https://discord.com/channels/290013534023057409/331882115119448065/852551515931017236
- getTeamInfoBySeason or fixRatingsStatsAbbrevs
- any abbrev returned in stats or ratings from playersPlus is wrong
- using team*Cache from UI is probably wrong too

if DRAFT_BY_TEAM_OVR, use position value in draft rankings somehow

mood effect of trading away a player should only be applied after the current phase is over https://old.reddit.com/r/BasketballGM/comments/nmz09w/fa_signing_probabilityasking_price_doesnt_change/gzrkjhr/

Don't allow sim to preseason while user is over roster limit? If the "sign a ton of players to see if they prog" thing becomes an issue
- or offseason roster limit https://discord.com/channels/290013534023057409/331882115119448065/847984927136022558

faceoff from penalty box after period ends https://discord.com/channels/@me/778760871911751700/845898372672913409

playoff series record in live box score messed up https://discord.com/channels/290013534023057409/290015591216054273/846468388565942333

fbgm trade rate

the better way to make FA more detailed but still simple would be to replace the "Sign" button with a "bid" button. And have FAs only take deals after you simulate forward a day. Allow teams to make deals that are +5 or +10 or +15% larger or smaller in the negotiate page, to make their chances of the FA signing with them better/worse. The get rid of the "player won't sign with you" thing. Just show a "chance of signing" given a certain size of deal https://discord.com/channels/290013534023057409/331882115119448065/846534950101843969

bundle size
- defer
  - react-select
  - all views? https://reactjs.org/docs/code-splitting.html#route-based-code-splitting
    - how many is too many?
    - performance hit if the current view is not in the main bundle?
- use a single rollup command for both ui and worker, so common code can go in a chunk, like https://github.com/rollup/rollup-starter-code-splitting/blob/master/rollup.config.js
  - do es module imports work inside a worker in firefox?
    - https://web.dev/module-workers/
    - https://caniuse.com/mdn-api_worker_worker_ecmascript_modules
    - https://bugzilla.mozilla.org/show_bug.cgi?id=1247687
  - for legacy bundle, need to include systemjs loader in worker, so it can load modules and init itself
  - remove blacklist plugin
  - do main and legacy builds in parallel
- confirm cache header
- confirm bugnsag working

teams run starting lineups with terrible guards because most GFs became SFs or Fs, even though their passing and dribbling are far better than whichever short guy now gets to start. the logic for who's on the floor when should probably be changed. https://discord.com/channels/290013534023057409/331882115119448065/840121129389391882

Re-enabling auto-save while auto-playing sometimes breaks the game. Uncaught (in promise) Error: Primary key "2480" already exists in "games" https://discord.com/channels/290013534023057409/290015591216054273/840126335501991957

counter proposals too jumpy, get rid of that extra iteration at the end maybe?
- https://discord.com/channels/290013534023057409/569726303926878219/840367834965213194
- https://discord.com/channels/290013534023057409/290015591216054273/854580914024480798
- add penalty for too many players in trade?
- try with and without overshooting (without meaning, don't add anyone worth more than the initial trade proposal) and if both work, pick the one with fewest assets

Live-simming a game being played by CPU teams in playoffs before simming your game on the same day causes the top game bar to stop updating. https://discord.com/channels/290013534023057409/290015591216054273/840604799539871744

fbgm2
- game sim
  - don't scramble if it's hail mary time
  - EPA based play selection?
    - nflscrapR https://old.reddit.com/message/messages/1151cu2
- test if team ovr formula is better now

trade finder, with salary cap rules enforced
- add checkbox to trading block, trade page
- add another "what would make this deal work?" button
- how should it work?
  - could work same as now, but never add a player that takes it above the limit, and then have an extra step at the end where it tries to add filler salary
  - even better - filler salary could be added up front, to allow taking a bigger contract back... but how exactly?

fbgm game sim breaks with 0 ovr players https://discord.com/channels/@me/837050122482352212/837810119567736832
- force 1 to be minimum? or add special case to the bounded gaussian function to just return the max/min at some point?

AI teams too likely to re-sign stars?

show team record and ovr on trading block, for picks (including traded picks) https://old.reddit.com/r/BasketballGM/comments/mhj2r2/monthly_suggestions_thread/gtprmml/

in god mode, add button to switch to controlling a team directly on the roster page https://discord.com/channels/290013534023057409/331882115119448065/837416287948111942

relatives editor use name search like awards https://discord.com/channels/290013534023057409/290013534023057409/836988210327715960
- jersey retire too https://discord.com/channels/290013534023057409/290013534023057409/836989205438660689

team rating should do something sensible if roster size or num players on court is different https://old.reddit.com/r/BasketballGM/comments/mhj2r2/monthly_suggestions_thread/guoseqe/

draft lottery animation for random draft https://old.reddit.com/r/BasketballGM/comments/mhj2r2/monthly_suggestions_thread/gtokjf0/

no height changes with 100% determinism https://old.reddit.com/r/BasketballGM/comments/mhj2r2/monthly_suggestions_thread/gu9tsqi/

scheduled events editor
- see "scheduled-events-editor" branch, shit's complicated

view console.log output from worker console UI https://discord.com/channels/290013534023057409/331882115119448065/836521637103796224

trade value of players vs picks as difficulty changes https://mail.google.com/mail/u/0/#inbox/FMfcgxwLtkQskcMSQwdhHzQvdwXMKqSG

playoff series W/L in live sim double incrementing https://discord.com/channels/290013534023057409/290015591216054273/835678883466313769

disable injuries without god mode before league? https://discord.com/channels/@me/831754887058423819/833206526780768277

auto buttons to height in player editor https://discord.com/channels/290013534023057409/331882115119448065/833532089281282058

create new 2021 league with realStats="all", go to season summary, best record teams still show up with their default names even if you have real team info override
- really should get rid of abbrev/region/name from that object and just store tid

Block numbers increase by >33% in playoffs, this is a bit too much!!! https://discord.com/channels/290013534023057409/290015591216054273/832653523644710953

hockey - torn acl -> spd increase https://discord.com/channels/290013534023057409/290015591216054273/832091096720998430

If you play a league with draft type:"no draft, rookies as free agents" ; random generated players still have a draft history
- https://raw.githubusercontent.com/alexnoob/BasketBall-GM-Rosters/master/ABA2000_2020-21.json
- https://discord.com/channels/290013534023057409/290015591216054273/830366298184876032

for shot type distributions, base it on real player ratings (model ratings -> shot distribution) "y= softmax(Wx) with x being ratings and y being the shot distribution." @nicidob
- even more fun... you can implement ideas like "midrange is the leftover shot" if you fix the logit value for the mid-range to a constant and just learn parameters for the other shots.
  - decay for non-starters... depends on # of starters, maybe? different if 1 starter or 5?
- last perk: you can do this independently for every single year (or batch the years) and either use those parameters raw or smooth them and get more fun historical curves that aren't just "3p tendency"
- https://old.reddit.com/r/BasketballGM/comments/luvq8s/monthly_suggestions_thread/gpbdvg2/
- make some flag to enable this for certain sports only, and do one at a time
- get rid of hacky position balance code for signing free agents, hopefully no longer needed

draft class quality setting
- by default, it's random
- override in "regen draft class"
- influence the new mode for real draft rankings
- check 0 age players in all

settings re-design
- some settings should only be editable in offseason
  - playoff structure
- to add
  - RPD does not affect pot https://old.reddit.com/r/BasketballGM/comments/kuiwap/i_think_the_new_update_with_the_real_players/gisc5mz/?context=3

hockey new lottery nhl2021

If you have “lose best player at the end of the season” turned on, there’s a pretty bad spoiler. If you live sim the final game of the season the tragic death will pop up as the game is starting. Issue is, it might be like a 3-2 series so you’ll know who won https://discord.com/channels/290013534023057409/290015591216054273/821886733058441247

better gold websites
- dedicated website, separate from game
- new stripe checkout https://mail.google.com/mail/u/0/#inbox/FMfcgxwLswLjSWCHtJMHJkFtKTwQXVKj

bbgm ai teams keep dynasties together too easily?

daily score summary https://discord.com/channels/@me/790622657284014120/818668678757089280

New bug: if you have a pop-up window open with the roster page or whatever, and you collapsed the score bar on that, you still get the little notifications for scores in the corner even on the main window where the score bar is showing
- also, trade in multiple windows

teams in hockey ignoring salary cap? maybe just to sign goalie? https://discord.com/channels/290013534023057409/290015591216054273/817944239442624522

hockey
- rather than no goalie fatigue in playoffs, maybe make it a small amount of fatigue?
  - if i do this, make sure to start best goalie (with fatigue? without fatigue?) in elimination games
- game sim performance
- ovr PR

change point value of 2/3 pointers https://old.reddit.com/r/BasketballGM/comments/ko1zy7/monthly_suggestions_thread/gjtthn2/

store w/l/t/otl for all players, similar to qbgRecord
- some kind of playing time cutoff for when a game counts for a player?

Add SOS and SOV stats on team stats since they have to be used for tiebreakers anyway https://discord.com/channels/290013534023057409/331882115119448065/810504463407382558

asian names https://old.reddit.com/message/messages/xje301

head to head records
- later
  - somehow store streak and last 10? would be nice in the head2head page. but would be annoying to account for all the filters (season, playoffs, etc)
  - on head2head, a chart like https://i.gyazo.com/9e3f36a8e53b1f1ec681170843ea0679.png (bar graph of win% against each other team) linking to head2head_matchup
  - head2head_matchup: summary of matchup between two specific teams
    - http://www.winsipedia.com/air-force/vs/army
    - list available box scores between teams
    - list statisitical feats between teams
    - link here from head2head and head2head_all

free agents should be more willing to sign with teams that overpay
- https://old.reddit.com/r/BasketballGM/comments/lccu22/observation_from_an_intermittent_player_free/

warning when trading away draft pick for nothing https://mail.google.com/mail/u/0/#inbox/FMfcgxwKkbnxZHrTjZZWLrrrxtthlrXz?compose=DmwnWrRnZvzzkvZLMpKFFjcCwGzpkjhWhFHgSvCgfXVGZDcnLSLBTxBVlXFkLZJGKBLFCpQVshmQ

madeHof
- copy fudge changes from basketball to football
- numGames scaling - use lower bound of games played each season

In live sim, when there is a foul, indicate how many fouls the team has so we can see how many fouls needed before the bonus https://discord.com/channels/290013534023057409/331882115119448065/800225337929105438
- timeouts too?

sim substitutions faster in live sim
- https://discord.com/channels/290013534023057409/331882115119448065/799434082802860073

bold scoring plays in live sim
- https://discord.com/channels/290013534023057409/331882115119448065/799434734101856312

real players prospect rating options
- base on career stats (maybe compute peak overall year and apply standard progs backwards to draft age)

phase out use of Team.cid and TeamSeason.cid - can get it from did

nicidob FBGM ovr
- https://discord.com/channels/290013534023057409/290015468939640832/796279896073568256
- https://discord.com/channels/290013534023057409/290015468939640832/796812223254364222
- distribution of players in new league, and distribution of ovr at each position?

league name being stored in file name
- https://discord.com/channels/@me/682666234604552221/796152730036731974

scheduled events documentation
- https://old.reddit.com/r/BasketballGM/comments/k7g2yu/tutorial_how_to_schedule_an_expansion_draft_in_a/

better asian names
- https://old.reddit.com/message/messages/xjbi7a

https://discord.com/channels/290013534023057409/331882115119448065/792603966063902741

name/colleges
- special entries in frequencies
  - _random - uniform random of all built-in countries
  - _default - built-in countries at their default probability
- races
  - some way to validate that all countries have races, and vice versa
  - update docs
- global default... should it override individual countries?
  - see comments in PlayerBioInfo in types.ts

allow import/export of league settings from New League page

add some more built-in teams
- maybe: Providence, Columbus, Louisville, Nashville
- foreign: Tokyo, Delhi, Shanghai, São Paulo, Cairo, Beijing, Karachi, Buenos Aires, Istanbul, Manila, Lagos, Kinshasa, Moscow, Paris, Bogotá, Jakarta, Lima, Bangkok, Seoul, London, Tehran, Kuala Lumpur, Riyadh, Baghdad, Santiago, Madrid, Singapore, Milan, Berlin, Rome, Athens, Belgrade, Vilnius, Zagreb, Warsaw, Sydney
- next
  - Hockey cities: Edmonton, Winnipeg, New Jersey
    - https://mail.google.com/mail/u/0/#inbox/FMfcgxwLttFTMwkKXVNBGJZHbhfPtsfl Miners, Winter
  - World cities: London, Beijing, Tokyo, Paris
  - By BBGM userbase: Manila, Syndney, São Paulo
    - capybaras
    - Rio Bossa Nova, Rio Carnivals, Rio sambas https://discord.com/channels/@me/849090991151513620
- Houston Asterisks

"find players" form
- customizable search boxes for stats/ratings
- table then displays only the columns you searched for, like stathead

trade filters
- https://old.reddit.com/r/BasketballGM/comments/kksxpp/proposal_trade_filters/

Noticed that if I auto play through resignings and FA teams always end up above the roster limit. Imo they should be able to cut players before progs. https://discord.com/channels/290013534023057409/290015591216054273/787667855775891476

force resign button under lock ratings, keep a man on one team
- hard cap
- maybe it should be "Force stay on team" which makes him unable to be traded and guaranteed to be re-signed
- @dooby moogey#2784

award editor
- Finals MVP displays regular season stats if you change it to someone who also played in that same finals. https://discord.com/channels/290013534023057409/290015591216054273/787237109924495412
- support adding custom awards
- support editing seasons older than the start of the league

UI for selecting a custom set of teams in a new league
- DOES THIS MAKE SENSE?
  - random players - sure, it's fine
  - real players, league file - gets a bit tricky for leagues starting after preseason, due to needing to match up tid/cid/did with various other objects, such as playoffSeries, scheduledEvents, teamSeason, etc
- after MVP
  - do we think of it as "editing the teams list of in some league file" or "specifying teams list, which may include additional info like adding real teams"? the latter is simpler, because then we start a league with no history or anything. but in UI terms it's unclear how to present it... like the "Customize" button is great for a random players league, because it already has no history or anything. but should that include access to real players? and how should the "main" flow be for accessing real players, should it be only from the "custom league" screen? if it's hidden in another dropdown, probably not many people would see it. so i guess it'd just be nice from a UI perspective if it could be made generic enough to work everywhere, but i don't know if that will be possible.
    - to work everywhere, needs to keep disabled teams too
- "Customize" link in "Pick your team", maybe next to "Random". that results in a list of custom teams+options in state, which is reset whenever you switch the season/phase for real players, or switch the customize setting on the right
  - does this make sense? what if we do a real players league and pick 2 custom teams with random players, what would that imply?
    - i guess that's fine... real players would be generated from the team configuration, and if there are none, there are none. all other settings from that real season would still apply
- clicking "Customize" takes you to a new page
  - list of teams by confs/divs
    - allow drag and drop to reorder confs/divs
      - https://github.com/atlassian/react-beautiful-dnd
    - allow drag and drop to move teams to other divs
  - add/edit team
    - region name, pop, stadium capacity, logo URL, srID (dropdown, not free text, and help popover explaining that real team overrides will apply), colors, include real players?
  - while viewing confs/divs/teams, buttons on the side
    - Presets
      - Default BBGM teams with random players
      - Real teams and players
        - shows a popup to let you pick a season and select if you want to include players or not
      - Legends
        - shows a popup to let you pick a decade
  - Save/Cancel buttons at the bottom
    - rewrite cids/dids/tids to be continuous on save
      - for tids need to be careful - tid is referenced in other parts of a league file, most importantly players, but also other parts. so maybe don't allow this from uploaded files?
        - if allow, store a map of (old file tid -> new league tid) and use it to update/delete all team-related objects
          - i guess same would be needed for cid/did
        - see makeTIDsSequential
      - need to be careful for cids too, see PlayoffSeriesTeam
        - even if we don't keep any history, need to consider in-progress playoffs
- for storing new NewLeague, keep separate from "normal" list of teams. show customize button in red (or something) when customized. when switching settings (like random to real, or season within real) keep customized teams.
- for real players leagues, make sure scheduled events are correct (delete any referring to teams that aren't there, and make sure tids are correct especially for expansion teams)
- appending season/index to player's name
  - track how many of each slug/season are in the league file. if a slug appears more than once, add just the season (or DP or the draft year, for draft prospects) to his last name if that season appears only once. otherwise, add an index number(like #1, #2, and #3 for 3 versions of the same player from the same season), including the season too if there's also more than one season (like 2018 #2)
  - how should this deal with mixing a legends team into a real league? legends already have season appended. could save that appending until post-processing, and just always make sure to add it for legends teams (whether in legends or normal leagues)
- what about players from a league file (uploaded or real players) that are not on any defind team? delete? make free agents?
- would be nice if the Customize Teams page was a new URL so the back button worked the same as "cancel"
  - will have same issue when adding a settings page
- blog
  - Want to create a league where the Eastern Conference is made up of all the real Atlanta teams from the 80s, and the Western Conference is made up of all the real Sacramento teams from the 90s, and have it start in 1962 and proceed with real players in the draft from there? I don't know why you'd want to do that, but you can do that.

ability to switch back to prior year
- In danger zone, button to reset to preseason of any season
  - preseason, or regular season? or pick phase?
- On export league, ability to export at any past preseason
- would need to store rosters each preseason, similar to groundhog day
  - new object store, primary key season, array of all roster infos?
    - do i ever want to suppport different phases? then primary key needs to be (season, phase)
    - delete old data
    - league export
    - league creation
  - write at the end of newPhase that switches to this season+phase?
- available seasons/phases populate the menu by looking at the keys of the object store
- also roll back teams, somehow
- roll back g changes, when possible
  - maybe store g in the object store too... { g, teams }
- g.repeatSeason could become a boolean that uses this (eventually, gotta worry about upgrades)
- maybe not...
  - in other games, this would be achieved by saving at different times. when that is easier (stream) that will be better
  - storing g is messy, since g already has a history mechanism

typescript 4.1 stuff

nicidob new ovr formula
- basketball: https://github.com/zengm-games/zengm/pull/275/files
  - see new-ovr branch
- football: https://paste.ubuntu.com/p/H5pPmb3r6J/
  - nicodob says:
    - as I said I rewrote this code (b/c I'm doing the testing on a different computer) and the PR uses .csv exports but this version uses .json leagues. https://github.com/nicidob/fbgm/blob/master/ratings.ipynb
    - that does the ratings and vomits out the over_under roster
    - as-is it basically eats FBGM or BBGM leagues up. It does the position-specific code. So to replicate the PR I just replace the pos = r['pos'] with pos='ALL' and the code is happy to do it
    - yeah I mean there's a handful of differences here. this uses JSON leagues (not a split 'avg.csv'/'game.csv'), and does position-specific breakdowns. But yes it's the same thing, it takes leagues with box scores and does minute-weighted rating differences to MOV for individual games
    - it also doesn't do the scaling to ensure the mean and variance are unchanged (i just check R^2 and move on)
    - And here I'm using L1 Regularization + Cross-Validation to drop a bunch of coefficients to zero for ratings that don't matter
    - the problem is i got really wonky distributions when I tried to output the FBGM stuff
    - like I don't understand how mean/variance are set by the code right now
    - the notebook spits out a copy+paste table for ovr.football.ts and I have a local copy with it but the numbers are big and positions are set - wrong because I deleted bonuses and.....
    - it was non-obvious to me how to get these in-game in a good way so I don't have a good PR

FBGM too many very short players

on trade summary page, also show how the player left the team (or if still active/retired). use p.transactions

Maybe another frivolty to say which players were the best with a certain pick, e.g. 1-3 would be Michael Jordan IRL, 1-1 would be LeBron James, etc @lewie100

trade summary charts future
- some indication for winning a championship, special marker?
  - tooltip required, for clarity
- tooltip
  - team region, name, record, playoff result
- https://github.com/airbnb/visx
  - would it make tooltips easier?

fuzz
- nicidob - fix fuzz uniformity so that it's more like 70 +/- 1, 60 +/- 3,  50 +/-5

more variation in pace plz @nicidob
- https://discord.com/channels/290013534023057409/290015468939640832/780515737139150890

how to stop 2p from beign a negative rating
- @nicidob says: basic summary: it's used only in "usage", but it's a small part of that, and "shoot midrange". Well... shoot midrange is like 0.8 to 0.9 PPS, while Dunks and 3s are 1.2 and 1.1 PPS. Sure, actual ratings shift the %s, but i'm not sure how extreme it'd have to get before your MR PPS isn't the "worst possible shot". So the 2p setting basically is "how likely are you to take the worst possible shot". My idea is to make the mid-range more of a "leftover"... if your 3p or dunk or LP isn't high enough, it gets picked. then higher 2p is just higher MR accuracy and its negative effect is gone. Then you can era-adjust the default

break difficulty setting into multiple components that can be controlled independently

finances in shorter season https://old.reddit.com/r/BasketballGM/comments/jtu1yr/someone_has_to_fix_this_the_finance_system_is/gcapqg7/

redesign draft screen
- on draft screen, add a new "Scouting" column that contains skills applied with lower cutoffs
- compute skills somehow.. lower cutoff? project future like pot?
- https://cdn.discordapp.com/attachments/331882115119448065/775567088584491018/unknown.png
- should not require scrolling on mobile

option to disable the cap entirely. Turn the Hard Cap option into "Cap Type" with "None, Soft Cap, Hard Cap". leave the setting for actual salary cap, so it can be used for all the contract computation. @nicidob

player page redesign
- collapse https://cdn.discordapp.com/attachments/331882115119448065/772161255922204732/image0.png

possible to enter into negotiations with a player, trade away other players so that now he refuses to negotiate, but still sign him because negotiations have already started
- check mood on negotiation page, even if negotiation already started

when I just deleted old data, processing after draft and pre season sped up atleast 200%
- if not fixable, then maybe add option to auto delete more stuff, not just box scores

trade balancing
- https://old.reddit.com/r/BasketballGM/comments/jhtm1k/im_playing_charlotte_queens_on_hard_mode_and_i/
- could value DPs and players before first progs more
- I don’t think it’s something intended to happen, pretty frequently if I trading block a late first round pick I get offers for guys drafted ahead of my pick
- care more about bad contracts
- FBGM should not demand as much in 2 for 1 trades? https://discord.com/channels/@me/696164463312764949/776342790586105877
- https://old.reddit.com/r/BasketballGM/comments/k3339l/the_cpus_lack_of_value_for_draft_picks_is/

profit for extreme caps needs to be fixed first, its not possible to make money above $400m cap space

during re-signing phase, should still show % everywhere except re-signing table. same with free agency, i think?

AI re-signing is just player mood + trade function
- later
  - have it affect free agent signings too

genSchedulePlayoffsDay -> genSchedulePlayoffsRound
- make whole round at once, accounting for how many games have been played
- when series ends, delete remaining games from schedule
- remove forceWin hack in setSchedule
- https://old.reddit.com/r/BasketballGM/comments/jd9vyg/new_feature_in_god_mode_to_select_the_winner_of_a/g9hgt09/

schedule editor

start in any phase
- later
  - get rid of keys.push("playoffSeries", "draftLotteryResults", "draftPicks");
    - need to improve LeagueMenu so fetching leagueInfo depends on both season and phase forms
  - start before expansion draft
  - start before draft lottery
  - support starting after playoffs even if there is an expansion draft
    - for 1947/48, ignore weird 2nd round picks and clone 1st round order for 2nd round
    - expansion team should be selectable
  - add player stats if phase after regular season
    - advanced stats will require team stats too... sum up from players?
    - advanced stats and other missing values, calculate on load?
  - what about changes to settings (like playoff settings, etc), does it need to store previous season's value too?
  - what about seasons with expansion teams?
    - tricky for draft, since it should have expansion draft as already happened... maybe disable those years
      - could get results of expansion draft and assing those players to team!

trade stuff
- more penalty for bad contracts

AI teams should release players if better FAs are available
- draft picks after first season, especially

centralize player action buttons
- buttons
  - Draft
  - Trade For
  - Trade Away
  - Negotiate
  - Sign
  - Release
- option to pick which to show, so it can replace NegotiateButtons
- show in player stats/ratings/bios tables? and roster, player profile?
- button group, or single button with dropdown
- help popover in column explains stuff, and text on confirm windows

contract extensions, available if player mood is high enough and contract is expiring

No trades or other finance/roster moves while job offers
- https://old.reddit.com/r/BasketballGM/comments/iz8bvk/exploit_1_get_job_offer_2_trade_all_of_your_stars/

https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html

GM face in team history page
- saved faces in account?
- allow overriding for specific league, or linking to one from your account (requries sync)

finances revamp
- get rid of raw $ amounts https://old.reddit.com/r/BasketballGM/comments/hvkmsp/icymi_2706_is_nowthe_lowest_you_can_spend_on/fyubmr8/?context=3
- https://old.reddit.com/r/BasketballGM/comments/ir5rbf/suggestions_for_finances_overhaul/
- make it clear how much profit the owner wants per year

redo mood system
- some way to see how it changes during FA - show probability? show # days until willing? https://old.reddit.com/r/BasketballGM/comments/iuluuj/the_new_player_mood_system_is_now_live_in_version/g5mgi31/
- customizable columns on roster page
- later
  - moodComponents.playingTime for football - based on depth chart
  - table showing all of the mood components as columns
  - should affect trades

player development - less correlation betwen ratings
- https://github.com/nicidob/gm-games/commit/fec2175636191ca96b60912601b3212be03bb7ad

gm score
- @nicidob
- almost like this https://fivethirtyeight.com/features/billion-dollar-billy-beane/ f(profit,win%,playoffRoundsWon)
- show on GM History
- fully dynamic, or store in TeamSeason?
- same as the owner mood score?
- https://discord.com/channels/290013534023057409/290015468939640832/770460701235478568
  - df['profit']- expected_profit(df['pop'],df['cap']) + (expected_cost(df['win'])-90000) + (expected_costP(df['playw'])-90000)
  - https://github.com/nicidob/bbgm/blob/master/gmRating.ipynb

taller players should get injured more

option in team history to have AI auto retire jerseys, similar to "keep auto sorted"

ratings stats popover should be based on year and allow switching https://media.discordapp.net/attachments/713482931447791648/755051634890899516/unknown.png?width=1439&height=71 @ninjasean56

offseason recap page https://old.reddit.com/r/BasketballGM/comments/im6pfb/suggestion_offseason_recap_menu/

injury notification in news feed should show ovr/pot drop

play menu race condition @whitecow ~/Downloads/BBGM_Sim_Bug.mp4

wordmarks on team history https://old.reddit.com/r/BasketballGM/comments/ik1kif/one_idea_for_use_of_the_secondary_wordmarks_for/

individual player determinism https://old.reddit.com/r/BasketballGM/comments/ij0bi7/would_it_be_possible_to_make_player_determinism/

salaries wrong after expansion draft? https://cdn.discordapp.com/attachments/290015591216054273/750472674953920572/unknown.png

When changing the jersey number on a player acquired in FA it also changes what that player's jersey number was on his previous team, despite him being signed to a different team now
- need to treat jerseyNumber like teamSeason stuff (name, etc) - store "latest" in root, and copy from there when making new stats row, if possible

Add game log to player page

option to disable unimportant notifications
- https://old.reddit.com/r/BasketballGM/comments/ier26k/pop_ups_disable/
- sirlamegame

nicidob PRs
- player overall ratings
  - maybe use new formula from other PR
- team overall ratings

jersey numbers
- higher limit for AI teams, and make panel collapsable
  - https://old.reddit.com/r/BasketballGM/comments/i55hvu/ai_jersey_retirement/g0onh40/?context=3
- AI unretiring jerseys should be based on WS
- later
  - better system to resolve conflicts (better player gets the number)
  - prompt to pick number of newly acquired players
  - add jersey retirement to awards list
    - No. 77 retired by the AAAA
    - tricky when user edits, would need to update player
  - notifications in news feed
    - redundant with HoF?

in box score, show graphs of score and win probability

nicidob contract stuff
- https://raw.githubusercontent.com/nicidob/bbgm/master/cbb_roster_2020.json << if u set max salary to 30M, lots of players go unsigned
  - seems to be related to number of teams... https://raw.githubusercontent.com/nicidob/bbgm/master/history_final.json has a milder version of the problem
  - also, it's really slow to do the bidding with so many teams/players
- FBGM - introduce team value into auction, for better position-specific contracts, based on team needs
  - https://github.com/nicidob/bbgm/commit/e795aea66917997b1ddbede8adc33b6ca20086f4
  - see new note in sn
- eventually
  - eliminate all genContract

team Offensive Rating and Defensive Rating on Roster screen? (not just MOV?)
- nicidob

rebuilding/contending in the old days https://old.reddit.com/r/BasketballGM/comments/hytv2e/whats_the_best_way_to_trade_for_good_draft_picks/fzf4iap/?context=3

option to lock ratings for all players, including future players

built-in UI to load custom user files
- UI in BBGM to create league
  - api to list league files
  - page in BBGM to list the league files, with links that go to the new league form pre-populated with that URL for a league file
- limit users who can upload
  - gwood
- database table to store metadata
  - id
  - user_id
  - sport
  - name
  - description
  - num_leagues_created
  - last_updated
  - version (increment every update, keep in URL)
- CRUD UI for people to upload/edit/delete league files

gradually reveal progs mode
- displayed ratings are f(t, current ratings, last year's ratings)
  - after like half the season, always just current ratings. prior to that, depends on phase and games played
  - reveal with some polynomial, like x^n, so it's not predictable if a small increase will lead to a big increase later

DataTable
- places to use sortValue (implemented) and searchValue (not implemented yet):
  - ImportPlayers inputs
  - Height/Weight in PlayerBios needs searchValue
  - NegotiateButtons (search for negotiate/refuses)
  - sorting by skills on draft history
  - would allow sorting by checked/unchecked for trade and trading block
  - get rid of awkward children stuff - PlayerNameLabels, mood, ...
    - then get rid of react-addons-text-content

allow user to cancel relocation if it's their team?
- what about contraction, what would that imply for future events?

contract formatting https://old.reddit.com/r/BasketballGM/comments/hotbbw/small_readability_issue_inconsistent_decimals_on/
- always show 2 decimal places?
- right align, and use tabular-nums so numbers are aligned?

The spending page needs to fixed. Either change the "finances" so you select "spending rank" (1st thru 30th) or make the finance system actually use cardinal values. right now it's confusing for new players and kinda annoying to set yourself as first the in the league (guess + check)

import/export players
- maybe
  - export
    - table alignment
      - skills and button are a little too big
  - import
    - checkbox to keep or delete history (stats, ratings, awards, HoF)
    - add import to event log? for individual player, or aggregate?

more realistic free agents when generating league
- look at retired young players from previous season

customizable columns in datatable
- future
  - SortableTable
  - supercols
    - change input format to be associated with these index numbers, then can derive which should be shown and where
    - or, change cols input to include flag for which supercol a col belongs to
    - but for MVP, no customization of supercols tables
  - always return all stats and ratings?

from survey
- people really like looking back at history
- people really want better playing time control
- player comparison should be better
  - https://bbgm6man.eiphi.eu/
- team comparison should be better
- better international name options
- player mood revamp (bigger contract, ring-chasing, etc)

fuzz/scouting revamp
- prospects and young players only
- fuzz is deterministic noise
- scouting budget affects accuracy of mood percentages?

add records to top scroll on desktop https://old.reddit.com/r/BasketballGM/comments/gyc615/news_feed_changes_are_live_in_version_202006070785/ftg0cvm/?context=3

way to save/load leagues on server
- ~/projects/google-drive
- MVP
  - import league from google drive
    - show files we have access to
  - export league to google drive rather than file
    - still need to track googleFileID, so it won't create a new file every time you export to drive
    - option to create new file or overwrite existing one
- Cloud
  - authorize and sign out buttons for google
    - https://developers.google.com/drive/api/v3/about-auth#save_refresh_tokens_in_long-term_storage
  - list of leagues in cloud
    - delete button
      - when deleting, delete file ID from local leagues too
    - rename button
    - link to create a new league with cloud file
  - https://developers.google.com/drive/api/v3/picker to add more files to list?
- Dashboard
  - link to Cloud page, and explanation if not logged in
  - for a league linked to a cloud save (with googleFileID etc)
    - if lastPlayed is greater than googleLastSync, show button to save changes to the cloud
    - if version in cloud is greater than googleFileVersion, show button to overwrite league with latest from cloud
    - if both of those things are true, show warning
  - for a league not linked to a cloud save (googleFileID is undefined)
    - show button to upload to cloud
  - some way to import leagues from the cloud (maybe another "New League" button, and support "Import" over existing one too)
  - some way to delete things from cloud
    - deleting a league locally should pop up an option of if you want to delete from cloud
  - design
    - condense some columns (name, team, difficulty) into one
    - add column for # seasons played
- Data stored locally
  - in each league, store google file ID, version, and timestamp of last sync (download or upload) w/ cloud
    - googleFileID
    - googleFileVerison
    - googleLastSync
- API
  - should this run all client side, or do we need a server side component?
    - try all client side first
  - authentication
    - https://developers.google.com/drive/api/v3/quickstart/js
    - store all keys and gapi object in worker
  - get list of cloud saves, including google file ID, BBGM league ID, last time played, and last phase/season
    - how to search for them? https://developers.google.com/drive/api/v3/properties says it is possible
      - https://developers.google.com/drive/api/v3/reference/query-ref
  - download existing save by google file ID
  - upload new save
  - update (overwrite) existing save
  - delete save
- for multiplayer leagues, some way to support other people having read access to a league
  - manual input of file ID or URL
- store on my system (s3 maybe) or use google drive?
  - google drive
    - https://developers.google.com/drive/api/v3/reference/files could put metadata in "properties"
      - use that to store some unique ID of the save
    - UI integration https://developers.google.com/drive/api/v3/about-apps
    - thumbnail https://developers.google.com/drive/api/v3/create-file#upload_thumbnails
    - challenge - how do i stream data out of IndexedDB and into Google Drive?
      - ideally would send data from IndexedDB to WritableStream to some HTTP API, but that doesn't seem supported - https://github.com/whatwg/fetch/issues/378 for the HTTP request, but also it's a problem with IDB auto closing transactions
      - so would need to read entire league file into memory first

FBGM
- in FBGM, tags aren't generated for custom roster's draft classes until the end of the season.
- rosters https://raw.githubusercontent.com/nicidob/bbgm/master/fbgm_roster_2019_sss.json
- some OL stat
- increase value of K/P so they won't be traded for nothing
  - user report of K/P being released by AI teams during season! AI teams should take roster construction into account here
  - @geonerd#6946
- smarter cutting when over roster limit (like don't cut only K/P)
- easier position changes, maybe from roster or player pages
  - auto sort roster after? or maybe have option to set if user controls roster sort or not
    - default should be "not"
- Add the release and trade away buttons to the depth chart screen. I find myself flipping back and forth from the depth chart and roster.
- Add the roster composition to any roster type screen like draft, depth chart, and trade screens.
- trade possible after playoffs phase begins, but only before first playoff game is played?
- weird offensive holding application https://old.reddit.com/r/Football_GM/comments/i33wix/penalties_wonky/g1073zl/?context=3
- DL in FBGM get way too many interceptions, CB should get more
- in FBGM, during the FA period with 30 days: injured players on rosters will not recover a single week if you sim to 1 day left in FA; injured players in fa will recover a week in every day of FA (30 weeks total)
- in OT, if the other team has already scored a FG, never punt!!!
- better support for running QBs to put up big numbers
- penalties accepted when normal gain would have been better
  - https://mail.google.com/mail/u/0/#inbox/FMfcgxwJZJZkXTNBnKVDvKLkMfMMTZdG
  - https://i.imgur.com/qb1Fuhf.png
- when a touchback occurs on an INT it doesnt say https://cdn.discordapp.com/attachments/682666234604552221/770164768425115678/unknown.png
- had a playoff game go to double overtime. with two minutes left in the first OT, I saw a score pop up on the scoring summary saying someone had kicked a field goal. that did not actually happen in-game. instead, the game went to the second overtime, where that field goal did in fact happen with two minutes to play. so basically, in double overtime games, the scoring summary updates scores for the second overtime at the times they happened, but in the first OT instead. first OT (field goal was not kicked, but the scoring summary updated anyways)
- penalty gives fewer yards than play, why accept penalty? https://discord.com/channels/290013534023057409/290015591216054273/776846929836507157
- holding penalty on offense advances the ball https://mail.google.com/mail/u/0/#inbox/FMfcgxwKjKsHRgGqXdslRhWNXMPvWsfh
- OT not immediately ending after FG https://discord.com/channels/@me/769709600353681429/779567122329763840
  - i can't reproduce this
- 0 game injury persists after game https://discord.com/channels/@me/769709600353681429/779898060947587114
- multiple QBs problem
  - switch from top value to top change in team rating, for both draft and FA
  - https://github.com/nicidob/fbgm/blob/master/how_to_select.ipynb
    - https://discord.com/channels/290013534023057409/290015468939640832/805212769841446932
    - https://discord.com/channels/290013534023057409/290015468939640832/805215950516256779
- base transactions on change in team rating
  - draft and free agency - probably 100%
  - trades - maybe 50/50? otherwise too easy to scam?
- small thing its difficult to trade in fbgm because teams are permanently in the contending strategy no matter how bad they are https://discord.com/channels/290013534023057409/331882115119448065/800250593049837590
- penalty on punt goes in wrong direction https://old.reddit.com/r/Football_GM/comments/l9xzhi/bug_report_penalty_goes_the_wrong_way/
  - https://discord.com/channels/290013534023057409/290015591216054273/831277650165104650
- holding on incomplete pass https://discord.com/channels/290013534023057409/290015591216054273/806339641924911154
- inappropriate spot foul? https://discord.com/channels/290013534023057409/290015591216054273/810358905988579359
- rookie contracts https://old.reddit.com/r/Football_GM/comments/kvf6cw/please_fix_rookie_contracts/
- wrong yardage for TD, then wrong team's kicker kicks xp
  - https://discord.com/channels/290013534023057409/290015591216054273/824808266008625204
- ovr revamp
  - base on composite ratings directly? https://discord.com/channels/290013534023057409/569726303926878219/822286234612924416
q- When an interception happens on the passer's side of field, the team that picks off the ball starts off from their own side https://discord.com/channels/@me/790622657284014120/840993492158644245
- opposing kicker kicks XP https://mail.google.com/mail/u/0/#inbox/FMfcgzGkXSSVJvRrWwqvGVzdxLfJLcJM
- all those change of possession bugs are on 4th down? https://discord.com/channels/290013534023057409/290015591216054273/854494812769484801
  - interception does not change possession https://mail.google.com/mail/u/0/#inbox/FMfcgzGkXSdhzzgXLSRMBzfwrZTdGWxL
  - OL intercepted pass from own QB https://discord.com/channels/290013534023057409/290015591216054273/853410221137199124
  - another change of possession weirdness https://discord.com/channels/290013534023057409/290015591216054273/854387307754160148
  - ...but a unit test on 4th and 1 and 4th and 50 run 100 times doesn't reproduce

eventually
- what happens to scheduled event if the user changes something relevant to it prior to the event happening? does this matter?
- show draft prospects separately when creating a new custom league, to allow creating one without them

redo trade system
- make it so that teams are less likely to trade for players when there is a better/ slightly worse player in FA for around the same price. people exploit that all the time
- some factor based on # of recent trades (similar to player mood revamp?)
- value of picks should depend of draftType setting

team needs/synergy display on roster
- and power rankings

---

BAA teams should enter with intact rosters, not expansion draft

relocation fun stuff
- would be cool to let people cancel a relocation of their team
  - could prompt them, and then if they say no still move their cid/did but leave the rest alone
- would be cool to let people move their team (and rebrand) by spending $

ovr formula should change depending on game simulation settings, especially 3 point shooting

what would it really cost to store all game sim results?

way to bookmark trades

player stats popover
- stats relative to league average
- ovr/pot graph over time
  - put this on player page too
  - https://old.reddit.com/r/BasketballGM/comments/g4m90u/suggestion_player_progression_graphs/

fuzz doesn't really make sense
- have it decrease as a player plays. so high only for draft prospects or unknowns

add copy league function
- https://old.reddit.com/message/messages/nmnr87

better trade finder AI
- handle salary matching constraint
- use in trading block, and betweenAiTeams
- after doing this
  - make sure big trades happen enough in betweenAiTeams - see random.choice weights in betweenAiTeams
  - also make sure betweenAiTeams doens't accept really bad trades, see dv2 check
    - especially for minor trades, not sure if dv as an absolute value rather than % makes sense

global key info (salary, days until playoffs, team  etc)
- league info: days until playoffs, standings/series
- finance info: salary, relative to cap and luxury tax. expiring contracts
- team info: needs (like... rebounding, perimeter defense, shooting, etc)
- ronen

condensed/composite rating views
- athleticism, shooting, defense, playmaking
- on ratings table, elsewhere?
- ronen

box score - more info
- team ratings (for active players in game)
- live
  - timeouts
  - football: position on field

redesign dashboard
- include some historical context
- top FAs
- award races
- injuries
- draft picks owned, and rank of team
- top draft prospects

events revamp
- eventually
  - nothing should be lost, ever
  - store info about trade, so the summary of a trade can be linked to
    - for traded picks, store info so eventual picked players can be filled in later
  - like trade above... all events should not have premade text, but instead have the metadata to generate it. then can do things like including RatingsStatsPopover
  - in playoffs, recovery should only be notable if the team is still alive
  - include all time records being broken, like career scoring, etc
  - merge some together
    - expansion draft teams in one event
    - contraction teams in one event

support changing team logos at any season, from predefined real team logos
- future
  - handle if the user edits something but realTeamInfo specifies an override
    - could check if the pre-overridden value is the previous override or not
    - could add a flag to track if a field has been edited or not
    - neiether of those is perfect
  - make player photo overrides dynamic too?

game sim improvements
- big men should shoot fewer 3s, and shoot better at the rim https://old.reddit.com/r/BasketballGM/comments/g26svo/all_of_bbgms_game_simulation_flaws_in_a_single/
  - https://discordapp.com/channels/@me/604773209837010944/700376777473654784
- ask what kind of players are not common enough

some kind of global status/finances menu, above titlebar
- EVENTUALLY
  - more info, not just games
    - progress bar showing phases, completion of season
    - mobile: only show either games or other info, with toggle between them
- scrollable
- animation on show/hide of LeagueTopbar
- some way to "lock" it so it stays fixed to the top of the screen

more animations
- RatingsStatsPopover modal opening
- games log
- schedule

pages for each playoff series https://www.reddit.com/r/BasketballGM/comments/4qjahi/minor_suggestion_generate_separate_pages_for_each/

login issues
- DefinitelyNotDonaldTrump on discord can help debug
  - from his debugging so far, the response from login.php is correct and the redirect to the account page happens, but local.username is still ""
    - is it not working correctly, setting through localActions?
    - or is it being overridden somewhere, like due to cross tab communication or the worker?
  - also says it happens on both BBGM and FBGM, and that it happens regardless of how many windows are open
  - console.log(document.cookie) - he says this returns an empty string, so i guess the cookie isn't being set somehow
    - would explain things, if cookie was not being set somehow. but should also be checked on account.basketball-gm.com directly

add toggle to table, to turn it into a heatmap showing which values are high or low. like think on a player stats table

FBGM punt when down in OT https://cdn.discordapp.com/attachments/290015591216054273/690387745042071592/Screenshot_2020-03-19_at_9.34.14_PM.png

make the 3 year delayed effect of team finances more obvious

teams play better/worse when down/up
- 10 point gap equals home court advantage
  - implementing exactly this would require letting player composite ratings change every possession... maybe too complicated
- @nicidob
- reference http://apbr.org/metrics/viewtopic.php?f=2&t=8501&start=0 in comment
- https://github.com/zengm-games/zengm/pull/276

redesign splash page
- https://twitter.com/i/events/879086180909764608?lang=en
- https://twitter.com/steveschoger/status/935541212626464770/photo/1
- https://medium.com/refactoring-ui/7-practical-tips-for-cheating-at-design-40c736799886
- other pages?
  - https://twitter.com/steveschoger/status/913062604540653568/photo/1

player page UI improvements https://old.reddit.com/r/BasketballGM/comments/fbja8g/more_ideas/
- deltas for ratings at the top
- highlight ratings based on comparison to position average (maybe like popover)

@nicidob Add an option to float the salary cap. Have it come from something like Sum(hype * population). So if NY/LA/CHI/MXC have bad teams, it's worse! Maybe even have hype depend on team rating (so if the whole league is playing crappy teams then the cap goes down).

add player who tackled to play by play
- Nate Oor Completed to pass to Jake buttham (Tackle by Shaun boof)
- https://discordapp.com/channels/@me/625036115497451609

in watchlist, if you have a player play the prior  year's playoffs and then they get an injury that keeps them out of the playoffs, it displays last year's playoff stats
- https://cdn.discordapp.com/attachments/290015591216054273/679836680420589690/unknown.png

Game list redesign
- later
  - show ovr in box score too
  - show player with highest game score under completed game

nicidob - Something like "Team Hall of Fame" based on wins/MOV/playoff

probGoForIt should account for being down by a FG or less late in the game

FBGM football sim bugs
- pass interference not giving first down https://old.reddit.com/r/Football_GM/comments/emhcfy/pi_penalty_not_resetting_to_1st_down/
- negative yard line https://i.imgur.com/fSHX6md.png
  - https://i.redd.it/r06r5jxc6ei51.png
- penalty on punt gives first down plus punt yardage https://cdn.discordapp.com/attachments/726675205669388293/733114315397136505/image0.jpg
  - https://media.discordapp.net/attachments/569726303926878219/738325008895705158/EvilQBFromChicagoZachTodd01.JPG?width=1141&height=581

typescript
- to do
  - backboard -> idb
    - my branch has two fixes:
      - https://github.com/jakearchibald/idb/pull/151
      - https://github.com/jakearchibald/idb/issues/152
  - any -> unknown
    - also in dependencies, like bbgm-router
- later
  - playersPlus
    - finish teamsPlus first, it's easier!
    - probably not worth attempting until there is a better way to share code. like anything in overrides is a problem cause it's not statically analyzable, including STATS_TABLES

switch Dropdown to DropdownLinks rather than Select?
- see how react-dropdown or react-select deal with tons of options
  - what about on mobile?
- https://stackoverflow.com/questions/40692950/how-to-make-long-bootstrap-dropdown-menus-vertically-scrollable

I should add easter eggs so that real historical figures sometimes appear in the game if you're simulating at that time. How dope would it be if you're simulating the 12th century and Genghis Khan shows up in the draft

Salary cap trade stuff

FBGM rookie contract length
- https://old.reddit.com/r/Football_GM/comments/eddhp1/fixing_ai_team_contract_logic/

value should be more ovr-based
- https://old.reddit.com/r/BasketballGM/comments/ecr0mw/20192020_nba_roster_v_11_traded_draft_picks_up_to/fbk80xj/?context=3

kicker trade value

god mode options for tendencies
- sport specific options, like shot tendencies, enabling/disabling 3 pointers, etc
- have them as sliders, where 50 means "no effect", 0 means "never happens", and 100 means "always". then blend those rates with the default rates behind the scenes
- maybe redo foulRateFactor this way

illness @mattable#4273
- pass to teammates or opponents
- list of diseases, each with a different average length and probability to spread
- if can be fatal, make sure to always create new FAs
  - playoffs?

add more variance in player development with some kind of professionalism/ambition rating https://old.reddit.com/r/BasketballGM/comments/e15yuv/unpredictability_of_progression_and_the_football/

team rating
- currently for past seasons, includes traded players on both teams. so intead, store value at end of each season
  - stored value will also make power rankings simpler and faster
- show on other pages, like team history
- team potential rating?
- somehow show everywhere, like how RatingsStatsPopover is for players
- change scale, make it harder to get 100?
  - but also don't make there be no variation in default leagues. maybe make it nonlinear 90+

god mode options
- population growth
- inflation of other revenue/expenses
- make them constant, or from a random distribution?

keep box scores with feats, and ASG

hype revamp
- make more transparent
- YWT

zipped files @Jofish#5051
- https://github.com/Stuk/jszip is a bit big, but CompressionStream won't work currently (doesn't make zip files)

https://react-hook-form.com/ for forms

more customize player options
- fixed position
- awards

football roster balance issues https://imgur.com/HmK00EF @Eddy

football OL with 49 height listed as 5'7"

https://old.reddit.com/r/nfl/comments/ct3eph/im_dumbmatter_creator_of_football_gm_a_free/exjp0b9/

"if you edit a player (change nothing) and hit save changes any new relationships added  or edited will appear"

option to control retirement rate

load file from url https://old.reddit.com/r/BasketballGM/comments/c54rov/automatic_nba_rosters_by_understanding/es28wcf/?context=3
- explanation text?
- docs
  - The tricky part is https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS which generally prevents websites from loading data from other domains, for security reasons. As described at that link in excruciating detail, you can allow a file to be included in another domain (or any domain) with the "Access-Control-Allow-Origin" header. If you don't control your server, that's not very helpful. But I have noticed that GitHub does this automatically on githubusercontent.com, so if you make a GitHub repo, you can use a link like https://raw.githubusercontent.com/user_name/repo_name/branch_name/file.json
- https://uppy.io/
  - file sharing platforms are sources, but not destinations?
  - requires server side integration

# football

some gamesim issues
- https://old.reddit.com/message/messages/ne69ad
- too many safeties

Can DL get more sacks and TFLs in FBGM? Tackle numbers on the DL are realistic now, so adding more sacks and TFLs would make it more realistic. Actually lower TFLs. There's several guys with more than 20 TFLs in my league. @☭☭#9825

infinite AV is possible
- https://media.discordapp.net/attachments/331882115119448065/600596243055509516/unknown.png?width=1440&height=423

blocked fg too uncommon?

Just started playing the other day and it's pretty fun! A lot different than BBGM but the roster management is fun even if the games can feel kind of random. Few things stood out. Not sure if this is just for balance purposes, but teams are WAY stricter about giving up next year's 1st round picks than in real life. I can package 3 amazing players and the best I get offered is a 1st 4 years in the future. Meanwhile IRL 1st rounders get traded for much less (Cooper for a 1st straight up).

Also I wonder if there is a way to present a player's value in regards to the position they play. What I mean is if I want to draft a good RB in the game I have to invest an early pick, but in the NFL teams find starting RBs day 3 on a pretty regular basis (although the argument there is OL is more important for the run game than the RB) so that might actually be pretty complicated to implement.

Finally I saw dumbmatter mention this in the initial post, but there really should be guaranteed rookie contracts. They are basically standard in the NFL and I don't see why a simulation wouldn't mirror this. Just feels weird all my players only want 2 year contracts when they are usually stuck with the team for 4 years at least. Just some initial thoughts, great work overall!

keyStats for OL should not show tiny # of tackles

rookie contracts too high still?

situationally aware play calling
- pass or run, hurry up or milk the clock with lead
- kneeling to run out clock
- clocking ball to stop clock
- hail mary as a separate play type?
  - needTouchdown

Also I just had my rookie QB get onto the All-Rookie Team in the QB slot, but he was also slotted in as an All-Rookie punter, without having done any punts all season.

stat distribution pages

too many players playing both offense and defense
- reassess after making roster construction better. if it's still a problem, only allow starter at one position
- too many fat guys with elite speed, small guys with elite strength?

weight formula is not very good

redo pot formulas?

---

Add "All Seasons" option to various stat/ratings pages
- Player Ratings
- Player Stats
- Team Stats
- League Leaders
  - Also add "Career Totals" there

injury later
- injury history leads to chance of reinjury
- height influences injury probability (see same paper as age)
- career ending injuries

can i get SideBar to have open state simply passed to it? performance might be ok now

why is free agency so slow?

button on free agents screen to fill out roster with players making up to 2x the minimum

exportPlayerGamesCsv only supports basketball currently, and it's disabled in ExportStats.js. football box scores are more complicated, more derived stats

way to specify routes for ShotLocations/RosterContinuity/Depth, so they aren't included in football/basketball routes

game sim
- pick playType from (down, toGo, scrimmage, score, quarter, time)
- later
  - clock
    - pace
    - clock management, strategy
  - for 2 point conversions and extra points, penalties don't actually move scrimmage currently!
  - log clutch plays
  - blocked fg
    - count as missed field goal
    - chance for either team to return (very slim for offense)
  - blocked punt
  - missed fg/xp return

AV advanced stat
- OL and defense
  - in individualPts, check if they actually seem to apply (no substantial rushing/receiving/passing stats)

how to get types working, options:
- make anything depending on an override or sport-sepcific type into a factory function or generic, initialized in deionWorker or deionUI and then passed around
- pass around overrides manually everywhere, not making it a module
- move everything inside deion

type better
- skills/compositeRatings - should be RatingsKey, not string for components. And PlayerRatings
- PlayerStatType should be sport specific
- getCopy/getCopies and Cache
  - awards should return Awards
  - players and playersPlus - Player<> and Player<MinimalPlayerRatings> should be Player<PlayerRatings>
- most MinimalPlayerRatings uses should be generic and take PlayerRatings

split more from deion
- processInputs for views only in one sport (depth, shot locations)
- worker API functions only in one sport (depth)

contract demands and position assignments should be based on which position maximizes p.value, not which position maximizes ovr. would you rather have an 80 ovr qb or a 100 ovr kicker?

RatingsOverview - could put in deion, with config to specify categories and names from getCols
- RatingsForm has this already! re-use

---

on import, error if any player/draftPick references an invalid tid

during free agency, after you sign all your free agents it should automatically take you to the league free agents and skip the step of having to continue

if a trade is highly unfavorable to the user, pop up a warning confirmation dialog

live game
- field with drive summary, football, direction, and last play

---

in table, sort position by constants.POSITIONS order (like roster page in football)

everywhere contract is displayed, make it in italics if not guaranteed
- currently only on roster i think. make a component!

"Accept Trade" button on trading block

AI teams should adjust finances

https://developers.google.com/web/fundamentals/app-install-banners/

after preseason, after player development, recalculate player value
- use ovr vs PER formula, but with offset based on prior value

Don't allow play if versions in tabs don't match
- close worker?

---

React.StrictMode

to send notification to correct screen, need `conditions` in views/allStars (and other getOrCreate calls). should be possible right? yeah, could request hostID from shared worker, and then sent it to runBefore functions, but... is it worth it? maybe not

BoxScoreRow
- link to team should be for the season of the ASG, not current season always (in boxScore.season but not passed to Row)
- highlight user team abbrev

Difficulty fudge factor should only be for user team (finances, trades)
- for trades this is hard because valueChange does not know if it's the user's team or not, need to accept another parameter

make AI smarter about contracts
- then do cool shit, like a tunable "randomness" factor or something that lets you tune player development, and also overall talent level, and also distribution of different ratings (to sim different eras)
  - https://www.google.com/search?q=OOTP+player+generator+modifiers&client=ubuntu&hs=nzO&channel=fs&sxsrf=ALeKk03DAwxNZl2Io6A0PwDmnR3InA95_w:1612847896152&source=lnms&tbm=isch&sa=X&ved=2ahUKEwjc07TPhtzuAhXlUd8KHdfaB9kQ_AUoAnoECA8QBA&biw=1920&bih=869#imgrc=qKcVVE7ByPY6xM

index updating
- currenty: check if the indexed property has changed, and only update a specific index then
- would be better: make _dirtyIndexes per index, not per store  
- even better: incrementally update index

later
- in new league: set rookie contracts appropriately
- in new league: initialize rebuilding/contending to non-random values
- don't include core.debug in prod builds?
- steeper penalties for unbalanced lineups
  - increasing perimfactor not enough - need to reevaluate formula. see all_bigs.json
    - perimfactor shouldn't be needed. just use the synergy stuff. should be offense and defense. check values for normal and extreme teams
- simulate draft from past seasons, to correctly assign contracts (don't need to populate actual draft info)

NEED TO FIX TRADE AI
- make tests of trades that should/shouldn't happen
- example: should never offer a strictly worse pick for a better pick. or at least not commonly

no POT mode, to make it harder

persist fantasy draft results
- make an array of draft results
- viewable somehow - need to track when fantasy drafts happened and add them to draft results menu

---

career totals on player pages https://www.reddit.com/r/BasketballGM/comments/7ya1yu/any_more_thoughts_on_the_beta/duptp08/?context=3

open multiple leagues from dashboard at the same time - Invalid cache status "filling"
- looks like flush is being called while status is "filling", can that be short circuited since idb.cache has been redefined? lid is different, or the hostID is different?
  - happens because it calls "flush" when closing an existing open database. should be more explicit about state of loading (no league loaded or loading, league X loaded and no league loading, league X loaded and league Y loading, no league loaded and league Y loading)
  - then will also need a way to prevent UI errors, if a UI update function is running and expects e.g. g to be populated but it's not - UI should check the aforementioned state as well and wait for loaded

reevaluate FA system - too easy to rebuild
- too many young stars available
- first pick at most players

somehow display synergy, maybe on roster page

watch list players should result in notifications when things happen (FA salary drops, trades, signings, release, retire)
- https://www.reddit.com/r/BasketballGM/comments/7h3eqy/simple_feature_request/

advanced team stats
- strength of schedule: https://www.pro-football-reference.com/blog/index9e6d.html?p=37&cpage=1
  - to set up this system of equations, need to know the schedule, but that is not stored anywhere currently. need to persist original schedule. maybe only soft delete games as they are played, or copy to another table?
  - use https://www.npmjs.com/package/linear-solve to solve
- team ortg/drtg/nrtg adjusted for strength of schedule

advanced stat table too confusing? needs vertical dividers/spacing?

use something besides PER in player value formula

new adv stats in roster page?
- switch PER to WS/48 - roster.js now pulling both, then eventually switch Roster.js
- same for HoF
- OR, wait for BPM?

per 100 possessions and totals toggle on team stats page

remove polyfills

add franchise leaders (stats) to team history page

marker for feats from the playoffs/finals https://www.reddit.com/r/BasketballGM/comments/6gpf1f/suggestion_a_marker_of_some_sort_next_to_game/

AI trades
- notification? only for big trades. quantify! maybe show that info in transactions page too

colors
- color ratings on ratings page (and tables), just like ratings popup
- color stats in ratings popover

force single tab per league
- when < 5 seconds, wait for another heartbeat before deciding
- check for collission in setInterval, and somehow show error page if that happens

shared worker
- namespace stuff, after it's working for one league
  - attach lid to promiseWorker instance in host (call it "metadata"), update lid if it changes, and attach to every request from host
    - then from worker, pass into toUI
  - query API: flag to determine if broadcast or single response. default single response. optional last arg, so single response use case is same API as now
    - if broadcast, then response is always undefined
    - broadcast needs to be namespaced, too. like only "update all league 5" not "update all tabs open in every league"
      - figure out some way to abstract... like maybe a conditional broadcast function defined based on metadata
  - namespace leagues (or force only one league)
    - namespace locks, g (in worker only), idb.league, and idb.cache
    - all common functions, accept g as param
    - something to handle init/close of tabs
    - look at all toUI calls
  - disconnect league when none are left registered to promise worker (so need api to get all metadata)

when dirty on close, show warning window, and initiate flush (if not already in progress)
- hard to coordinate across UI and worker...

this shit is UGLY UGLY UGLY, fix ASAP!!!
  if (typeof it === "function") { return; }

get tests working
- db.getCopy.teams
  - operate on individual functions? can export them just for tests
  - confirm operations that don't require IDB
  - confirm getAll updates from cache

document cache data format and API!
- different things are cached, depending on object store
- all modifications go into cache
- cache mutations are dangerous, see getCopy
- read from just the cache if you're sure everything is there (like an active player). otherwise, read from db and augment with cache (because anything could be in cache, even if it's not normally.. like retired player added to watch list). getCopy variables do this

----

situational awareness
- possession length
  - ? timeouts to advance ball (shorter possession) or make subs
  - ? shot clock violation
- fouls
  - ? sometimes foul when up 3 and not much time left
  - ? hack a shaq
- rotations
  - ? sub in good FT shooters in late game situations

https://www.reddit.com/r/BasketballGM/comments/57cux2/small_issue/

Trade/Signing Negotiation Difficulty - Have from a scale of 1-100. 1 = Signing players will be easy and salary dump trades. 100 = Most players ask for max contracts, and trading and salary dumps will be harder. 50 = Normal

---

REACT later

Draft button on player pages https://www.reddit.com/r/BasketballGM/comments/53op85/feature_request/
Trade Away button on your own players

Draft
  make it cooler
  fantasy draft is hacky and glitchy - do better!
    https://www.reddit.com/message/messages/6ip35c

---

Tools > Export Stats only has latest team, for in-season trades

filters on event log
  tragic deaths https://www.reddit.com/r/BasketballGM/comments/52ljuy/would_it_be_possible_to_add_a_memorial_page/d7ou7ov?context=3

make positions edited in god mode sticky, like custom roster

substitutions fucked up in long games https://www.reddit.com/r/BasketballGM/comments/44nv0s/100000_minute_quarters/

more detailed negotiation screen https://www.reddit.com/r/BasketballGM/comments/416o5g/well_this_is_new/cz11w9v?context=3

delete most negotiation code
  remove restriction for one negotiation at a time
    make sure re-signing is handled okay still
    make sure multi team mode is handled okay still
    get rid of negotiations object store

bold highest values in career on player stats tables like wikipedia https://www.reddit.com/r/BasketballGM/comments/4rgn0p/two_statrelated_suggestions/

Add 'Free Agents' to 'Teams' dropdown menu on 'Player Ratings' page. https://www.reddit.com/r/BasketballGM/comments/3t4kl6/suggestion_add_free_agents_to_teams_dropdown_menu/

team dropdown in dashboard

https://www.reddit.com/r/BasketballGM/comments/3gjqgd/lets_brainstorm_a_bit_about_this_30_seasons/

fantasy draft summary https://www.reddit.com/r/BasketballGM/comments/3g4p5a/issues_with_fantasy_draft_records/ (link is in player transactions)

crime https://www.reddit.com/r/BasketballGM/comments/3g1ngn/its_2015/ctudznu

minutes directly, not by +/-

use positions for roster building and rotations
  free agents and trades matters....
  bump up penalties for unbalanced teams
    the tricky part is that finding a factor and using it to create variance leads to variance on the CPU-generated teams
    could play with turnover probability too
    rewrite gamesim, fixing all these problems? also, coaching less agressively when game is blowout, playing stars more in important games, ...
    tricky: good teams have high skill players, who are going to do really well in any synergy metric. so it's hard to punish unbalanced teams through synergy without decreasing parity by a lot
      hacky approach: stay with something similar to current system, but with an extra penalty for very unbalanced teams (could be sigmoidal so it only affects really poorly balanced teams)
    probably will need to increase synergyFactor
    might need to tweak some probabilities if this changes stats too much
    redo ovr formula
    decrease importance of height: https://www.reddit.com/r/BasketballGM/comments/6rg7yr/height_is_too_impactful_in_bbgm/

Make AI smarter when constructing teams. Then, if that works, make synergy more impactful

when retired, player page (and other career-level things) should display most common pos, or maybe composite that us union of all positions (like GF for someone who was both SG and SF)
  draftHistory, hallOfFame, player, playerStats (careerTotals), teamHistory, anything else?

compact feats UI http://www.reddit.com/r/BasketballGM/comments/341k8e/can_we_have_statistical_achievements_sorted_by/
  add subtype or something to feats

DEATH
  types
    plane crash (whole team, 1 every 200 years)
      give extra draft picks as compensation?
        what would the nba do?
      reset owner mood, new owner message
      https://old.reddit.com/r/BasketballGM/comments/m087u6/could_we_get_something_like_this_as_an_extremely/

composite ratings / scouting report
  "Shooting", "PG Skills", "Paint Scoring", rebounding
    are these ones really complicated enough to warrant display?
  height trait http://www.reddit.com/r/BasketballGM/comments/2uccrl/viewable_composite_ratings_what_do_you_think/co7a4gr
    make it position-dependent.. but then should all this be position dependent?
  "The Shooting, Defense, and Style groups are the ones I'm finding Im paying most attention to"

team and league records (highest scoring game, etc)
  http://www.reddit.com/r/BasketballGM/comments/2sl13h/many_people_have_requested_some_kind_of_all_time/
  show in
    player page
    team history page
    season summary page

transaction log
  anything else to add or anywhere else to use this feature? ask
    big AI free agent signings
    team transactions page

player.updateValues.getStats doesn't really make sense. Should get all from past 2 seasons, sort by PSID, and take stats up to 2000 minutes

PLAYER DEVELOPMENT REVAMP
-------------------------

shouldn't have literally every aging player turn into a great shooter

old players are currently undervalued

TEAM.VALUECHANGE REVAMP
-----------------------

https://www.reddit.com/r/BasketballGM/comments/585af3/the_trade_ai_is_too_easy_to_abuse/
http://www.reddit.com/r/BasketballGM/comments/2v26p1/how_are_you_exploiting_the_trade_ai/
IMPORTANT http://www.reddit.com/r/BasketballGM/comments/20i6v3/still_too_easy_to_trade_for_drafted_players/
  just drafted players are undervalued, possibly related to the following issue
second round draft picks are undervalued. also, giving away a pick should never make a trade worse, but sometimes it does now. http://www.reddit.com/r/BasketballGM/comments/2bg3zx/simple_feature_mark_players_as_offlimits_when_we/cj5ap89
  similarly, trading block for nothing can net you second round picks
trade for tons of cheap second round picks, then use that to trade for good asset: www.reddit.com/r/BasketballGM/comments/27wjnp/33_pennies_for_a_dollar/
release and resign pick exploit http://www.reddit.com/r/BasketballGM/comments/1zn61h/finances/cfvzr35\
some limit on trades so people can't make 1000 slightly beneficial trades: http://www.reddit.com/r/BasketballGM/comments/1zzwbs/suggestions_on_trades/cg0e0dg
  probably make opposing owners less likely to trade as the number of proposed trades increases in a season
Eventually:
  "What would make this work?" functions should know about contending/rebuilding. Contending teams should be more eager to offer up young/cheap players, rebuilding teams should be more eager to offer up old/expensive players
    basically, they should view the trade from the other team's perspective, not just their own
  Can I provide better feedback about trade? Like if it's close or not? Or if it's rejected because of cap space issues?
  Set params with optimization algorithm
  Fix needToDrop stuff
    Problem now is, contract gets pushed into someone on the roster and it's lost. This is especially obvious if there is only one player in add and his contract is pushed to roster, then the trade is nothing.
    Probably not that important, since teams almost always have shitty players at the end of their rosters
  EXPLOIT that might be tricky to solve: in the "resigning players" phase, your free agents should still count towards your cap. Otherwise, you can trade to take on salary and then sign your players over the cap
  Should draft pick contract "worth" be determined better somehow, like it is for normal contracts? probably yes
    does this allow removal of fudge factor?
  population (i.e. richness) should influence opinion of contracts

CURRENT
-------

great ideas: http://www.reddit.com/r/BasketballGM/comments/2q9yn8/ideas_questions_and_feedback_feel_free_to_add/
career ending "injuries" http://www.reddit.com/r/BasketballGM/comments/2oo32x/are_there_career_ending_injuries/
"My Career" page with GM stats across teams http://www.reddit.com/r/BasketballGM/comments/2gc4sf/gm_page/
+/- http://www.reddit.com/r/BasketballGM/comments/2cpdxg/both_individual_and_5man_units/
account
  more pages
    account/edit
    account/:username (public profile showing achievements)
"Watch list" of players the user is interested in, mainly for free agency
  add "actions" where appropriate, probably as output in player.filter so it can be used elsewhere
    negotiate
      factor out negotiateButton code from freeAgents and negotiationList and player page (if possible)
      some heuristic to see if player is a negotiable
      show mood too?
    draft, fantasy draft
      if prospect, add "draft" button?
      if so, factor out from draft page and add on player page
    ADD TO PLAYER PAGE, elsewhere?
show prospects before draft
  EVENTUALLY
    ratings should really update annually, just like in normal years
      fuzz changing for prospects should factor in changes in scouting budget
    movement between draft classes
      allow promising to draft a player at certain position to influence decision
career stats
  EWA in averages should be average
    same with per36
per36, totals, playoffs options elsewhere
  currently in playerStats and watchList, but too much copy/paste. refactor before expanding
  team history
  roster
per 36 stats in player pages http://www.reddit.com/r/BasketballGM/comments/1ofz6s/per36_stats/
http://www.reddit.com/r/BasketballGM/comments/1sarll/open_source/cdxx3ql
notification system
  customize: http://www.reddit.com/r/BasketballGM/comments/1re3ea/new_feature_notification_bubbles/cdmjdyn
  what about for small screens? maybe just show one at a time. is this actually a problem?
  also log these events:
    fired - log, but don't show
    new team
  notify
    when something happens to a player on the watch list
    big AI moves - trades, free agent signings
  merge "retired" and "HOF" notifications for a player on the user's team
  important notifications should be a different color, maybe require acknowledgement before closing
    errors
    refuse to sign
    retire
  colors/icons for good/bad things http://www.reddit.com/r/BasketballGM/comments/22bpwm/suggestion_notification_improvements/

BIG NEW FEATURES
----------------

player stat summaries http://www.reddit.com/r/BasketballGM/comments/2bf4z0/functionality_of_the_game_vs_2k/cj5ir16
display of relative ratings like https://mail.google.com/mail/u/0/#inbox/144a4a04330edf3d
trade improvements
  refactor trade module with all the below in mind
    clean up even more?
      should create and updatePlayers be merged? updatePlayers already updates tids too
      either way, they should take partial objects and fill in the default/existing values
  trade suggestions (and trading block) should know salary rules
    HOW?
    team.valueChange could be made fast if I allow an extra argument to pass pre-fetched values from the database
    quick fix: check box to only look for teams under the cap http://www.reddit.com/r/BasketballGM/comments/1qh107/proposed_trades_question/
  trades between AI teams
    call team.checkRosterSizes after this if it's in between days
team switching after being fired
  keep track of what team the user controlled, so stats for the user (not the team) can be shown
random events
  like.. player gets suspended, out X games. or player gets into fight, fan support drops. etc.
more detailed draft - slower picks, trades, etc.
  slower picks http://www.reddit.com/r/BasketballGM/comments/1r70dv/trade_picks_during_draft
  sort by generic value (current) or team-specific value
  trade picks - note that the code in teamValue will need to be modified to account for the lottery and available players in the draft class
contests: post roster file and goal

BIG NEW GAMEPLAY CHANGES
------------------------

Extended free agency
  order of AI team signings shouldn't be linear
  0 year contracts http://www.reddit.com/r/BasketballGM/comments/1p0sa8/new_feature_extended_free_agency/ccy4gvp
  AI teams can release players to sign a better free agent?
fix contracts, signing
  goal: reasonable total payrolls, no good free agents left every season
  if WS distribution matches NBA, then look at $ vs WS. even better, build a multivariate model with age
  contracts should take ratings into more account, since stats on a good team are inflated and stats on a bad team are depressed
  player contract amounts http://www.reddit.com/r/BasketballGM/comments/1kj0p0/can_i_turn_off_firing/cbpxjyj?context=3
gameSim
  mediocre three point shooters should shoot it less http://www.reddit.com/r/BasketballGM/comments/2bwvpj/psa_players_who_shouldnt_shoot_3s_continue_to/
  smart substitutions http://www.reddit.com/r/BasketballGM/comments/2b9w78/went_7012_with_this_roster_is_this_really_that/cj3zgui
  big men should score more, shoot more FTs http://www.reddit.com/r/BasketballGM/comments/2amqpo/how_come_all_of_the_top_scorers_are_always_3_guys/
  pos/neg effects add on like civ4 defensive bonuses?
  balance http://www.reddit.com/r/BasketballGM/comments/1jfcjw/game_imbalance_fc_with_rdi/ http://www.reddit.com/message/messages/1097mj
  http://www.reddit.com/r/nba/comments/1j1e6q/i_made_a_singleplayer_basketball_management/cbfzr43?context=3 http://www.reddit.com/r/BasketballGM/comments/1k1881/pf_stands_for_powerful/
    too easy to get high percentage inside looks even with a team of all bigs?
    or should some of the "bigs" really be smalls, just mislabeled as PFs?
  make it less easy to get high percentage shots if there is no ball handling
    tweak perimFactor and synergyFactor.
  increase turnovers, particularly if perimFactor (or similar) is low
  increase fouls if perimFactor (or similar) is low
  assists should be function of speed, since those players have the ball more
  situational awareness http://www.reddit.com/r/BasketballGM/comments/1yg6wi/end_of_game_simulation/
  mediocre players on bad teams should be less efficient (shouldn't put up such a high PER, which falls if they join a good team)
add free agent to the end of roster
"My Player" mode http://www.reddit.com/r/BasketballGM/comments/2swmwj/there_should_be_a_game_like_myplayer_in_2k/cntkvj4

MINOR FIXES
-----------

documentation
  http://www.reddit.com/r/BasketballGM/comments/2agxoe/questions_and_suggestions_from_a_new_player/
Add MVP and Titles columns to HoF table
on team history, show counts of conf/league championships, hall of fame players, etc
if a player refuses to resign, that decision should also be reflected in free agency (don't recalculate mood)
add "drb" to usage so that good ball handlers shoot more (favor guards over bigs more)
in player page, show red/green for ratings changes from the previous year, maybe as heatmap
in ratings tables, show dpot and dovr columns? maybe?
replace random.gauss with random.realGauss
don't need to check every team's roster limits every time games are played - could auto keep AI teams in line after any trade (with user or between AI teams), and then only the user's team needs to be checked

LOW PRIORITY
------------

track longest W/L streaks
team chemistry http://www.reddit.com/r/BasketballGM/comments/2oco2a/simple_suggestion_team_chemistry/cmrpap6?context=3
box plots / distributions
  "it'd be great to overlay your roster to see where you stand. Maybe click on a name in a list to add or remove it from the display. Do I have a fast team? Do I have a three point shooting team? Are we big and bruising and slow?"
compare players http://www.reddit.com/r/BasketballGM/comments/1saclf/suggestion_compare_players/
fantasy draft
  when fantasy draft is over, go to summary of the draft
    do this in core.draft.untilUserOrEnd
  add entry for fantasy draft summary to draft history dropdown?
league settings
  enable/disable trading rules
cross-league play
mobile UI, bootstrap 3
  do something about hover tooltips
    injury
    skills
      for injury and skills, maybe make the whole block a hyperlink that opens a popover
        make sure to use on player page too.. can i use helpers.playerName.. there too?
    table headers
    others?
some kind of playoff series overview page, including box scores for easy access
A year-to-date comparison of team finances with the previous year.
dashboard info should be on a widget accessible from any screen
player search page
  show stats, ratings, contract, etc. (customizable); allow filters to be applied. also filter by skill icon
  search by stats, ratings, or attributes
  trade for button, or sign button if free agent, or draft button if draft prospect
    same contextual buttons for watch list
    can this become main UI for drafting (at least fantasy draft)
finances
  too easy to make big $$$
    owner should take profits each year
  AI teams should adjust spending
harsher, more realistic luxury tax
midlevel exception
more refined control of playing time
  http://www.reddit.com/r/nba/comments/1j1e6q/i_made_a_singleplayer_basketball_management/cbaegpq
  http://www.reddit.com/r/BasketballGM/comments/1qaml8/playing_time_explain_to_me_like_im_8/
  just set minutes directly? any minutes not included, leave up to coach's discretion
trades
  cash
    estimate value of cash - different for different teams? depending on cash, net profit recently, and market size
    upper limit? what is NBA rule?
  more feedback from AI
    if trade is close/far from working, return different messages
    display some indication of what a team wants to do on the trade view, e.g.
      "I need to cut my payroll and start making more money."
      "I could really use a good rebounder."
  sign and trade (only during resigning phase)
export/import roster
  some way to specify startingSeason
  easily edit in excel?
increase hype for big free agent signings
how to handle aggregating stats for players who played for more than one team in a season? add them all up in ps in db.getPlayers
  for roster, want just a player's stats with this team this season
    this currently works, just pass a tid
  for player stats view, want total among all teams for one season
    no pass tid and you only get the latest row. need added logic to do sum
  for player view, want separate and combined rows in careerStats without fucking up totals (including PER)
    no pass tid and you get each team separately, but no merged stats as above
if fouling out drops team below 5 active players, play fouled out players but add a FT each foul (technical)
show old contracts on old roster view
core.trade refactoring
  validateSavedTids crap should be in trade.js.
  trade.summary stuff should be automatic and stored in tradeStore
  trade and clear buttons should be disabled during gameSim, with message like in team finances
final score, hall of fame
  influenced by size of city (see: difficulty in views.newLeague)
AI modules that contain functions which are called to determine actions
  things to regulate...
    draft picks
    signing free agents
    resigning players
    trades
    budget items (like from team finances view)
    releasing/buying out players when over limit
some UI showing the state of the team's synergy. maybe like an advisors screen that suggests what kind of player is needed to improve synergy
  also can respond to budget changes
  more general: have "media" reporting things like 10 worst contracts, etc
like on team finances page, anywhere else to add help popups?
  should this be abstracted rather than just inline in views?
  inline anything from the manual?
AI updating of *Budgets and ticket prices
  maybe not necessary at this stage?
  call core.finances.updateBudgetRanks() after
update formulas
  nationalTvRevenue
    same for each team, change contract year by year and display in team finances
  localTvRevenue
    eventually, t.seasons[0].tvContract

@TheRealGWood#4891 Team traits
  Have you ever played CK2?
  I ask because the more comments I see like that reddit post the more simple I think replacing Mood with traits would work. 
  CK2 uses them. You can created TRID trait ID store as 1-10 or something fir starters-
  Injury prone - 10% higher injury frequency 
  Chronic injury- 20% higher injury chance, 10% higher - result from injury 
  Erratic- -5 Mood, -5 for every other erratic or Ego
  Ego- +5 mood, -10 minutes under 30 or usuage under 28%
  Demands a Trade- Won’t resign. -10 team mood 
  Team leader- +5 team mood, +1DIQ team, +1 OIQ team
  Savy Vet- better team progs, +1 team mood , unhappy if losing 
  Team player- +1 team mood
  Ball hog- -1 team mood +1 mood if usuage over 25%
  Farewell season- +3 in all traits final game and forced retire at end of season, +1 team mood
  Franchise player - (only over 70’s) max 1 per team or mood= -10, 
  Star- team mood + 0.5, savy vets more likley to sign 
  Bookworm- +3 OIQ/DIQ 
  Idiot- -3 OIQ/ DIQ , team mood -1

  Team traits-
  Deep playoff run= (CF) team mood+ 2
  Chip- team mood +1
  Got a star- team mood +2
  Has franchise player- Team mood +1
  FAiled to make playoffs ect....

  This would allow for DM to later add:
  Lazy
  Hardworking
  Workaholic

  Out of Shape 
  Prime Shape 

  Streaky 
  Consistent 

  Clutch
  Choke artist 

  And settable traits-
  Minutes restriction 
  Load management 
  Sixth man (won’t start)
  Primary ball handler 
  Primary scorer 
  Go to Shooter

FUTURE
------

event log UI
  allow filtering type with checkboxes
  what about events with no tid? they are currently not viewable
shot charts showing hot spots (red/yellow/green) based on shot location data
If you are simulating through the whole season and execute a trade while simulating, it will continue simulating even if you are over the roster limit. http://www.reddit.com/r/BasketballGM/comments/1xch01/trades_after_season/cfamo73
hire/fire different coaches with different strategies
boxplots for shot location stats, plus comparison to NBA data
import/export stuff
  online "locker" that you can sync saved games to
moving to other cities
team finances view
  compare bar graphs against league averages?
different size stadiums, building new stadiums
tv revenue as a variable
  local tv contract - $10 million
    base on tvContractAmount, tvContractExp
    will be a deal from 3 to 5 years in length
    based on...
      region population
      "hype"
      random noise
      "random event" - competition between two networks, Sports TV and The Basketball Channel
    when renegotiating and really bad, the guy pretends not to know you - "Atlanta Herons? Is that the team from the Mexican/Canadian/Arena/Indoor/Xtreme Volleyball/Soccer/Tennis/Racing/Curling/MudWrestling League?"
input to helpers.formatCurrency (and all currency in variables everywhere) should be in 1000s of dollars and then only converted to millions when displayed
AI teams should have to deal with fuzz too
live play-by-play simulation
  change of possession with no rebound/turnover?
  could fake where the shots are to display graphically
  allow the user to make substitutions in realtime
multi team trades

# BELOW IS OLD STUFF

AI (NON-GAMESIM)
----------------
AI teams release/buy out players to sign a better free agent
